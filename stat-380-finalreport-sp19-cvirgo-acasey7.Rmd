---
title: "Final Project Report"
author: "Andrew Casey & Ciara Virgo"
date: "Due April 30, 2019"
output: html_notebook
---

```{r echo=TRUE, message=FALSE}
# always clean up R environment
rm(list = ls())

# loading packages
library(mdsr)
library(tidyr)
library(data.table)
library(stringr)
library(dplyr)
library(ggplot2)
library(klaR)

# loading in data
Death_Raw <- fread("NCHS_-_Potentially_Excess_Deaths_from_the_Five_Leading_Causes_of_Death.csv")
Heart_Raw <- fread("Behavioral_Risk_Factor_Data__Tobacco_Use__2010_And_Prior_.csv")
```

```{r}
#Filter the Smoking Data to narrow it down to 3 States and years common between the two data sets
#Also remove all, but the necessary columns
DeathData <-
  Death_Raw %>%
  dplyr::select(Year, `Cause of Death`, State, `Age Range`) %>%
  filter(`Cause of Death` == "Heart Disease") %>%
  filter(State %in% c("Pennsylvania", "Texas", "Washington")) %>%
  filter(Year %in% c(2005, 2006, 2007, 2008, 2009, 2010))

#Filter the Heart Disease Data to narrow it down to 3 states and years common between the two data sets
#Also remove all, but the necessary columns
HeartData <-
  Heart_Raw %>%
  dplyr::select(YEAR, LocationDesc, TopicType, TopicDesc, MeasureDesc, Sample_Size, Gender, Race, Age, Education) %>%
  setnames(old=c("YEAR","LocationDesc", "Age"), new=c("Year", "State", "Age Range")) %>%
  filter(State %in% c("Pennsylvania", "Texas", "Washington")) %>%
  filter(Year %in% c(2005, 2006, 2007, 2008, 2009, 2010))

#Remove the rows that contain Male and Female, so there are only rows with Overall.
Rows1 <- HeartData$Gender=="Overall"
HeartData <- HeartData[Rows1,]

#Remove the rows that contain All Ages for the age range
Rows2 <- HeartData$`Age Range`=="All Ages"
HeartData <- HeartData[Rows2==FALSE,]

#Remove the rows that have anything but All Grades as the education level
Rows3 <- HeartData$Education=="All Grades"
HeartData <- HeartData[Rows3,]

HeartData <-
  HeartData %>%
  dplyr::select(-c(7,8,10))

#Changes the Sample Size column to numeric variables
HeartData$Sample_Size <- as.numeric(gsub(",", "", HeartData$Sample_Size))
HeartData$Sample_Size <- as.numeric(as.character(HeartData$Sample_Size))
```

```{r}
Age <- Heart_age$`Age Range`

  if(Age == "18 to 24 Years"){
    
  }
```

```{r}
#Changes the labels of the Age Ranges in both data sets so they are common
for(i in 1:length(DeathData$`Age Range`)){
  if(DeathData$`Age Range`[i] == "0-49"){
    DeathData$`Age Range`[i] <- c("44 Years and Below")
  }
  else if(DeathData$`Age Range`[i] == "0-54"){
    DeathData$`Age Range`[i] <- c("45 to 64 Years")
  }
  else if(DeathData$`Age Range`[i] == "0-59"){
    DeathData$`Age Range`[i] <- c("45 to 64 Years")
  }
  else if(DeathData$`Age Range`[i] == "0-64"){
    DeathData$`Age Range`[i] <- c("45 to 64 Years")
  }
  else if(DeathData$`Age Range`[i] == "0-69"){
    DeathData$`Age Range`[i] <- c("65 Years and Older")
  }
  else if(DeathData$`Age Range`[i] == "0-74"){
    DeathData$`Age Range`[i] <- c("65 Years and Older")
  }
  else if(DeathData$`Age Range`[i] == "0-79"){
    DeathData$`Age Range`[i] <- c("65 Years and Older")
  }
  else if(DeathData$`Age Range`[i] == "0-84"){
    DeathData$`Age Range`[i] <- c("65 Years and Older")
  }
}
for(i in 1:length(HeartData$`Age Range`)){
  if(HeartData$`Age Range`[i] == "18 to 24 Years"){
    HeartData$`Age Range`[i] <- c("44 Years and Below")
  }
  else if(HeartData$`Age Range`[i] == "25 to 44 Years"){
    HeartData$`Age Range`[i] <- c("44 Years and Below")
  }
}
```

```{r}
#Function that makes the data longer by duplicating the number of rows by the value in the sample size column and making the data set have more rows.
CasestoRows <- function(HeartData){
  Year <- vector()
  State <- vector()
  TopicType <- vector()
  TopicDesc <- vector()
  MeasureDesc <- vector()
  AgeRange <- vector()
  for (i in 1:length(HeartData$Sample_Size)){
    Year <- c(Year, rep(HeartData$Year[i], HeartData$Sample_Size[i]))
    State <- c(State, rep(HeartData$State[i], HeartData$Sample_Size[i]))
    TopicType <- c(TopicType, rep(HeartData$TopicType[i], HeartData$Sample_Size[i]))
    TopicDesc <- c(TopicDesc, rep(HeartData$TopicDesc[i], HeartData$Sample_Size[i]))
    MeasureDesc <- c(MeasureDesc, rep(HeartData$MeasureDesc[i], HeartData$Sample_Size[i]))
    AgeRange <- c(AgeRange, rep(HeartData$`Age Range`[i], HeartData$Sample_Size[i]))
  }
  df <- data.frame(Year, State, TopicType, TopicDesc, MeasureDesc, AgeRange)
  return(df)
}
Heart <- CasestoRows(HeartData)
```

```{r}
Heart_age <- 
  HeartData %>%
  select(`Age Range`)

head(grep("[18]", Heart_age, value = TRUE))
```